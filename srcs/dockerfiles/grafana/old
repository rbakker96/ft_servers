# Pull basic image
FROM    alpine

# Author
LABEL   rbakker grafana dockerfile

# Update software packages
RUN		apk update
RUN		apk upgrade --available
RUN     apk add --no-cache su-exec
RUN		apk add wget

# configurations
RUN addgroup grafana && \
    adduser -s /bin/false -G grafana -S -D grafana

# install grafana
RUN     wget -c https://dl.grafana.com/oss/release/grafana-6.7.2.linux-amd64.tar.gz
RUN		tar -xzvf grafana-6.7.2.linux-amd64.tar.gz
RUN     mv grafana-6.7.2 /grafana
RUN		rm -rf grafana-5.0.4.linux-x64.tar.gz

# Select volume
VOLUME  [ "/grafana" ]

# Open access ports
EXPOSE	3000

# Start influxdb
COPY    srcs/start.sh /tmp
RUN     chmod +x /tmp/start.sh
CMD     sh tmp/start.sh
